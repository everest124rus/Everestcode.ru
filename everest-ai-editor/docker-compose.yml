version: '3.8'

services:
  app:
    build: .
    ports:
      - "5005:5005"
    environment:
      - NODE_ENV=production
      - PORT=5005
      - HOST=0.0.0.0
      - DATABASE_URL=postgresql://everest_user:55dff8lt@db:5432/everest_ai_editor
      - JWT_SECRET=your-super-secret-jwt-key-change-in-production
      - GIGACHAT_AUTH_KEY=ZTVlZDhkYzMtZjM1Mi00MmE2LTg4MGItZGI3MjAyMGY4NzNkOmZhNjFmM2Q0LWMzMWItNGI5MC1hY2U1LTdjNzczOWI0MjcwZg==
      - GIGACHAT_CLIENT_ID=e5ed8dc3-f352-42a6-880b-db72020f873d
      - GIGACHAT_SCOPE=GIGACHAT_API_PERS
    depends_on:
      - db
    volumes:
      - ./build:/app/build:ro

  db:
    image: postgres:15-alpine
    environment:
      - POSTGRES_DB=everest_ai_editor
      - POSTGRES_USER=everest_user
      - POSTGRES_PASSWORD=55dff8lt
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
